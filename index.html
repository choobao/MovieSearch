<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>최고의 영화를 보고싶다면</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <style>
        .header {
            height: 150px;
            background-color: aqua;

            font-size: 25px;
            color: black;
            text-align: center;
            line-height: 130px;
        }

        body {

            background-color: black;
        }

        .search {
            height: 75px;
            border-bottom: 1px solid blue;

            background-color: aquamarine;
            text-align: center;
            line-height: 50px;
            font-size: 25px;

        }

        .card {
            margin: 30px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;

        }
    </style>

    <script>

        let url = 'https://api.themoviedb.org/3/movie/top_rated?language=en-US&page=1'
        const options = {
            method: 'GET',
            headers: {
                accept: 'application/json',
                Authorization: 'Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiI0ZTYzYjdjMWU5ZTIyZDAwM2ZjNjc5OWZlNjhmZWIxZCIsInN1YiI6IjY1OGViOWUxY2EwZTE3MDhmNGJhNzVkMyIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.h4S8wIqJ0DxjJ9506Hrj3F5AfsavVajdG9cVybz_RnM'
            }
        };

        fetch(url, options)
            .then(response => response.json())
            .then(response => {
                let rows = response['results'];

                rows.forEach(a => {
                    let title = a['title']
                    let id = a['id'] 
                    let overview = a['overview']
                    let vote = a['vote_average']
                    let path = a['poster_path']
                    console.log(response)

                    let temp_html = `
                    <div class="card mb-3" style="max-width: 540px;" id="card-${id}">
                        <div class="row g-0">
                            <div class="col-md-4">
                                <img src="https://image.tmdb.org/t/p/w500${path}" class="img-fluid rounded-start" alt="...">
                            </div>
                            <div class="col-md-8">
                                <div class="card-body">
                                    <h5 class="card-title">영화제목:${title}</h5>
                                    <p class="card-text">${overview}</p>
                                    <p class="card-text"><small class="text-body-secondary">평점:${vote}</small></p>
                                </div>
                            </div>
                        </div>
                    </div>`

                    //$('#card').append(temp_html); 
                    
                    // var cardElement = document.getElementById('card');
                    // cardElement.insertAdjacentHTML('beforeend', temp_html);

                    //바닐라 JS로 api 연동, html 붙여넣기
                    let cardElement = document.getElementById('card');
                    cardElement.innerHTML += temp_html;

                });

                //card id값 지정함. 하나씩 돌려가며 alert event id 띄우기!!
                let idd = document.getElementById('card')
                let xx = document.getElementsByClassName('card mb-3')
                console.log(xx);
            
                for(let i=0;i<xx.length;i++){
                    
                    // function click(window.alert('id: '+id)) //id도 지정? split?
                    const click = (event) => {
                    // id = xx 문자열 중 앞에서 9번쨰부터 시작, .으로 끝나는 문자 지정

                     
                       let id= event.currentTarget.id; //id값을 지정하기!!!!!!!!
                       
                        // let y= u[i];
                        let z = ""

                        // z += y.substr(9); //097.card.md-3
                        // console.log(z)
                        // let id = z.split('.',1)

                        


                        
                        
                        alert('id: '+id)
                    }
                    xx[i].addEventListener('click',click)

                }

                 

                //console.log에 찍고싶은 아이디....
                //카드아이디가 1,2,3이다. foreach밖에서는 모름. id값으로 검색하면 
                //element 자체에 들어가서 순환하기.... rows를 다시쓰면 아이디

                //배운거 정리
                //card-id이런식으로 각 아이디를 붙여줌
                //foreach문 밖에서 새로 조정을 해줍시다. cardid 값을. 지금 카드가 저 백그라운드까지 다 포함되있으니까 
                //또 지정새로해주고
                //새 foreach문으로 alert event 만들어주기


            }
            )



    </script>
</head>

<body>
    <!--헤더-->
    <div class="header">
        내배캠 최고 평점 영화 콜렉션
    </div>


    <!--검색창-->
    <div class="search">
        영화 검색 : <input type:text>
        <button>검색</button>
    </div>


    <!--카드창-->
    <div>
        <div id='card'>

        </div>
    </div>




</body>

</html>



<!--TopRated Movie
const options = {
    method: 'GET',
    headers: {
      accept: 'application/json',
      Authorization: 'Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiI0ZTYzYjdjMWU5ZTIyZDAwM2ZjNjc5OWZlNjhmZWIxZCIsInN1YiI6IjY1OGViOWUxY2EwZTE3MDhmNGJhNzVkMyIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.h4S8wIqJ0DxjJ9506Hrj3F5AfsavVajdG9cVybz_RnM'
    }
  };
  
  fetch('https://api.themoviedb.org/3/movie/top_rated?language=en-US&page=1', options)
    .then(response => response.json())
    .then(response => console.log(response))
    .catch(err => console.error(err));

    물어볼것
    저 api주소가 맞는지? 왜 난 세개밖에 안뜸..
    catch err일시에는 에러를 띄우는 건가염?
    암튼 성공적인 결과에는 콘솔로그로 띄운다는거 아닌가??
-->